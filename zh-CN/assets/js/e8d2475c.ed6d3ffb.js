"use strict";(self.webpackChunkadguard_knowledge_base=self.webpackChunkadguard_knowledge_base||[]).push([[7671],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),s=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=s(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(r),m=a,f=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return r?n.createElement(f,i(i({ref:t},u),{},{components:r})):n.createElement(f,i({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},7936:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>p});r(7294);var n=r(3905);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const l={title:"Protect Mail Activity and AdGuard",sidebar_position:8},c=void 0,s={unversionedId:"adguard-for-mac/solving-problems/protect-mail-activity",id:"adguard-for-mac/solving-problems/protect-mail-activity",title:"Protect Mail Activity and AdGuard",description:"\u672c\u6587\u4ecb\u7ecd Mac \u7248 AdGuard\u3002\u8fd9\u662f\u4e00\u6b3e\u591a\u529f\u80fd\u5e7f\u544a\u62e6\u622a\u7a0b\u5e8f\uff0c\u53ef\u5728\u7cfb\u7edf\u7ea7\u522b\u4fdd\u62a4\u8bbe\u5907\u3002 \u8981\u4e86\u89e3\u5176\u5de5\u4f5c\u539f\u7406\uff0c \u8bf7\u4e0b\u8f7d AdGuard \u5e94\u7528\u7a0b\u5e8f\u3002",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/adguard-for-mac/solving-problems/protect-mail-activity.md",sourceDirName:"adguard-for-mac/solving-problems",slug:"/adguard-for-mac/solving-problems/protect-mail-activity",permalink:"/KnowledgeBase/zh-CN/adguard-for-mac/solving-problems/protect-mail-activity",draft:!1,editUrl:"https://github.com/AdguardTeam/KnowledgeBase/edit/master/docs/adguard-for-mac/solving-problems/protect-mail-activity.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{title:"Protect Mail Activity and AdGuard",sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"iCloud \u4e13\u7528\u4ee3\u7406\u548c AdGuard",permalink:"/KnowledgeBase/zh-CN/adguard-for-mac/solving-problems/icloud-private-relay"},next:{title:"\u9ad8\u7ea7\u8bbe\u7f6e\u6307\u5357",permalink:"/KnowledgeBase/zh-CN/adguard-for-mac/solving-problems/advanced-settings"}},u={},p=[{value:"In a nutshell",id:"in-a-nutshell",level:2},{value:"\u66f4\u8be6\u7ec6\u7684\u8bf4\u660e",id:"\u66f4\u8be6\u7ec6\u7684\u8bf4\u660e",level:2},{value:"Recommended solution",id:"recommended-solution",level:2}],d={toc:p};function m(e){var{components:t}=e,r=i(e,["components"]);return(0,n.kt)("wrapper",o(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}({},d,r),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"\u672c\u6587\u4ecb\u7ecd Mac \u7248 AdGuard\u3002\u8fd9\u662f\u4e00\u6b3e\u591a\u529f\u80fd\u5e7f\u544a\u62e6\u622a\u7a0b\u5e8f\uff0c\u53ef\u5728\u7cfb\u7edf\u7ea7\u522b\u4fdd\u62a4\u8bbe\u5907\u3002 \u8981\u4e86\u89e3\u5176\u5de5\u4f5c\u539f\u7406\uff0c \u8bf7",(0,n.kt)("a",{parentName:"p",href:"https://agrd.io/download-kb-adblock"},"\u4e0b\u8f7d AdGuard \u5e94\u7528\u7a0b\u5e8f"),"\u3002")),(0,n.kt)("h2",{id:"in-a-nutshell"},"In a nutshell"),(0,n.kt)("p",null,"Apple \u90ae\u4ef6\u5e94\u7528\u73b0\u4e8e\u4e0b\u8f7d\u90ae\u4ef6\u56fe\u50cf\u65f6\u4f7f\u7528\u4ee3\u7406\u4ee5\u9690\u85cf\u7528\u6237\u7684 IP \u5730\u5740\u3002"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/mac/mac_protectMailActivity.jpg",alt:"Mail privacy protection"})),(0,n.kt)("p",null,"However, it won't work if there's an active VPN connection. \u56e0\u5176\u89c6 AdGuard \u4e3a VPN\uff0c\u6240\u4ee5\u5b83\u4e0d\u4f1a\u81ea\u52a8\u9884\u8f7d\u56fe\u50cf\u3002"),(0,n.kt)("p",null,"Apple explains this issue ",(0,n.kt)("a",{parentName:"p",href:"https://support.apple.com/HT212797"},"here"),"."),(0,n.kt)("h2",{id:"\u66f4\u8be6\u7ec6\u7684\u8bf4\u660e"},"\u66f4\u8be6\u7ec6\u7684\u8bf4\u660e"),(0,n.kt)("p",null,"\u73b0\u5728 Mac \u7248 AdGuard \u4f7f\u7528\u57fa\u4e8e\u7f51\u7edc\u6269\u5c55 API \u7684 macOS \u5185\u7f6e\u7684 Socket \u8fc7\u6ee4\u3002 \u8fd9\u79cd\u65b0\u7684\u6f0f\u6d1e\u767e\u51fa\u7684\u673a\u5236\u53d6\u4ee3\u4e86\u8001\u5f0f\u7684\u5185\u6838\u6269\u5c55\u3002 \u5728\u8fc7\u53bb\u7684\u4e00\u5e74\u534a\u5185\uff0c\u6211\u4eec\u5411 Apple \u62a5\u544a\u4e86\u8d85\u8fc7 20 \u4e2a\uff08\uff01\uff09\u5173\u4e8e\u5176\u65b0\u8fc7\u6ee4\u65b9\u5f0f\u7684\u9519\u8bef\u3002"),(0,n.kt)("p",null,'\u7f51\u7edc\u6269\u5c55 API \u6709\u4e00\u4e2a\u7c7b\u4f3c VPN \u7684\u914d\u7f6e\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u7c7b\u4f3c\u8def\u7531\u7684\u6761\u76ee\u5217\u8868\u3002 On Big Sur, AdGuard used "split-tunnel" rules to avoid creating the "default route" rule because it causes problems on early Big Sur releases. These problems were solved in Monterey so nothing prevents us from using the "default route" rule.'),(0,n.kt)("p",null,"\u5728 Monterey \u4e0a\uff0c\u63a8\u51fa\u4e86 iCloud \u4e13\u7528\u4ee3\u7406\u3002 Privacy features of Mail.app also use Private Relay servers."),(0,n.kt)("p",null,"As a consequence, AdGuard can't work together with iCloud Private Relay and Mail app privacy features:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"iCloud Private Relay is applied to connections at the library level \u2014 before they reach the socket level, where AdGuard operates."),(0,n.kt)("li",{parentName:"ol"},"iCloud Private Relay uses QUIC, which AdGuard can't filter because HTTP/3 filtering is not yet available."),(0,n.kt)("li",{parentName:"ol"},"Consequently, AdGuard blocks QUIC, including iCloud Private Relay traffic \u2013 otherwise, ad blocking is impossible."),(0,n.kt)("li",{parentName:"ol"},'When you use iCloud Private Relay and switch AdGuard into the "split-tunnel" mode, you can\'t open websites in Safari.'),(0,n.kt)("li",{parentName:"ol"},'To work around this issue for Monterey, we apply the "default route" rule. When Private Relay sees that rule, it disables itself automatically. So, AdGuard works seamlessly on Monterey, but iCloud Private Relay gets disabled.')),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"network.extension.monterey.force.split.tunnel"),' restores the "Big Sur" behavior, but this option may break access to websites due to (3) and (4). We keep searching for a solution to this issue. One of the options is implementing HTTP/3 filtering.'),(0,n.kt)("h2",{id:"recommended-solution"},"Recommended solution"),(0,n.kt)("p",null,"At this point, we recommend using a more traditional VPN service, such as ",(0,n.kt)("a",{parentName:"p",href:"https://adguard-vpn.com/"},"AdGuard VPN"),", instead of the newer Apple privacy features."))}m.isMDXComponent=!0}}]);